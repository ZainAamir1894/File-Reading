import java.io.*;
import java.util.*;

public class GenericFunc{
   public static void main(String[] args){
    try{
        File file = new File("C:\\temp\\EVE01Sales.txt");
        Scanner sc = new Scanner(file);
        HashMap<String, Integer> prod = new HashMap<>();
        HashMap<String, Integer> regionName = new HashMap<>();
        HashMap<String, Integer> time = new HashMap<>();

        handleFile(sc, prod, regionName, time);

        System.out.println("Product-Wise Sales: ");
        printSale(prod);

        System.out.println("Region-Wise Sales: ");
        printSale(regionName);

        System.out.println("Month-Wise Sales: ");
        printSale(time);

    } catch (IOException e){
        System.out.println("Error Reading File.");
    }
   }

   public static void handleFile(Scanner sc, HashMap<String, Integer> prod, HashMap<String, Integer> regionName, HashMap<String, Integer> time ){

     if(sc.hasNextLine()){
        sc.nextLine();
     }

     while(sc.hasNextLine()){
      String line = sc.nextLine().trim();

      String[] fields = line.split("\t");
      String month = fields[0];
      String date = month.split("-")[1];
      String productName = fields[3];
      String region = fields[1];
      int qty = Integer.parseInt(fields[4]);
      int uPrice = Integer.parseInt(fields[5]);
      int amount = qty * uPrice;

      handleSale(time, date, amount);
      handleSale(regionName, region, amount);
      handleSale(prod, productName, amount);


     }
   }

   public static void handleSale(HashMap<String, Integer> map , String key, int amount){
      if(!map.containsKey(key)){
        map.put(key, 0);
        map.put(key, map.get(key) + amount);
      }
   }

   public static void printSale(HashMap<String, Integer> map){
      for(String i : map.keySet()){
        System.out.println(i + " : " + map.get(i));
      }
   }
}
